<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Authority Dashboard</title>
  <style>
    body{font-family:Arial,sans-serif;margin:0;padding:20px;background:#f1f5f9}
    h2{color:#1e40af;margin-bottom:20px;text-align:center}
    table{border-collapse:collapse;width:100%;background:#fff}
    th,td{border:1px solid #ddd;padding:10px;text-align:center}
    th{background:#2563eb;color:#fff}
    tr:nth-child(even){background:#f9fafb}
    tr:hover{background:#e0f2fe}
  </style>
</head>
<body>
  <h2>Authority Dashboard</h2>
  <table id="busTable">
    <tr>
      <th>Bus No.</th>
      <th>Driver Name</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Last Update</th>
    </tr>
  </table>

  <script>
    function loadData(){
      const allData = JSON.parse(localStorage.getItem('busLocations') || "{}");
      const table = document.getElementById('busTable');

      // reset header row
      table.innerHTML = `
        <tr>
          <th>Bus No.</th>
          <th>Driver Name</th>
          <th>Latitude</th>
          <th>Longitude</th>
          <th>Last Update</th>
        </tr>
      `;

      for(const bus in allData){
        const {driver, bus: busNo, lat, lng, time} = allData[bus];

        const row = `
          <tr>
            <td>${busNo}</td>
            <td>${driver || "â€”"}</td>
            <td>${lat.toFixed(5)}</td>
            <td>${lng.toFixed(5)}</td>
            <td>${time}</td>
          </tr>
        `;

        table.innerHTML += row;
      }
    }

    setInterval(loadData, 3000); // refresh every 3 sec
    loadData();
  </script>
</body>
</html>
